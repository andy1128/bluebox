{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initia-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <title>Bluebox</title>
    <link rel="stylesheet" type="text/css" href="{% static 'catalog/index_style.css' %}">
    <script src="{% static 'catalog/indexjs.js' %}"></script>
<body class="body_class">    

    <h1>This is a heading for index</h1>
    <form method="GET">
    {% csrf_token %}
    {{ form }}
    <button type="Submit">Submit</button>
    <button type="button" onclick="showSearchedMovie()">Reload with movie chosen</button>
    </form>

    <div class="container" id="image_cont">
        {% for movie in movies %}
            <a id='{{movie.id}}' data-link="{{movie.link}}" data-img="{{movie.img}}" data-director="{{movie.director}}" data-actors="{{movie.actors}}" data-sd_price="{{movie.sd_price}}" data-title="{{movie.title}}"  onclick='chckOutPage(this.id, this.getAttribute("data-link"), this.getAttribute("data-img"),  this.getAttribute("data-director"), this.getAttribute("data-actors"), this.getAttribute("data-sd_price"), this.getAttribute("data-title"))'> 
                    <img src='{{movie.img_r}}'></img>
                </a>        
        {% endfor %}
    </div>

    <script type="text/javascript">
        function chckOutPage(clicked_id, clicked_link, clicked_img, clicked_director, clicked_actors, clicked_sd_price,clicked_title){
            // var image_id = document.getElementById(clicked_id);
            // alert(clicked_link);
            window.location.href = "checkout.html" + '#' + clicked_id + '#' + clicked_link + '#' + clicked_img + '#' + clicked_director + '#' + clicked_actors + '#' + clicked_sd_price + '#' + clicked_title;
        
        }

        function showSearchedMovie(){

            document.getElementById("image_cont").innerHTML = ' ';
            var image_local = "{{search_result}}";
        
            if(image_local.search(',')){
                image_local = image_local.split(',');

                var i;                
                var arrayLenght = image_local.length; 
                for (i = 0; i < arrayLenght; i++) { 
                    image_local[i] = image_local[i].replace("'", "");
                    
                    var dir = image_local[i];
                    dir = dir.replace("[&#39;", "");
                    dir = dir.replace("&#39;]", "");
                    dir = dir.replace("&#39;", "");
                    dir = dir.replace("&", "");

                    var image_click = document.createElement("a");
                    // image_click.href = "checkout.html"
                    image_click.id = "image_" + i;
                    image_click.setAttribute('image_click_src', dir);
                    image_click.onclick = function(){
                        window.location.href = "checkout.html" + '#' + image_click.getAttribute('image_click_src');
                    } ;
                    document.getElementById('image_cont').appendChild(image_click);
                  

                    var image = document.createElement("img");
                  
                    image.src = dir;
                    document.getElementById('image_' + i).appendChild(image);
                }   
            }
        }
    </script>
</body>
</head>
</html>